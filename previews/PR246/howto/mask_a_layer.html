<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>... mask a layer? · Species Distribution Toolkit</title><meta name="title" content="... mask a layer? · Species Distribution Toolkit"/><meta property="og:title" content="... mask a layer? · Species Distribution Toolkit"/><meta property="twitter:title" content="... mask a layer? · Species Distribution Toolkit"/><meta name="description" content="Documentation for Species Distribution Toolkit."/><meta property="og:description" content="Documentation for Species Distribution Toolkit."/><meta property="twitter:description" content="Documentation for Species Distribution Toolkit."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.svg" alt="Species Distribution Toolkit logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Species Distribution Toolkit</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Index</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/arithmetic.html">Arithmetic on layers</a></li><li><a class="tocitem" href="../tutorials/statistics.html">Stastistics on layers</a></li><li><a class="tocitem" href="../tutorials/consensus.html">Creating a landcover consensus map</a></li><li><a class="tocitem" href="../tutorials/occlayers.html">Layers and occurrence data</a></li><li><a class="tocitem" href="../tutorials/pseudoabsences.html">Generating background points</a></li><li><a class="tocitem" href="../tutorials/futureclimate.html">Future climate data</a></li></ul></li><li><span class="tocitem">How-to...</span><ul><li><a class="tocitem" href="get_gbif_data.html">... get data from GBIF?</a></li><li><a class="tocitem" href="know_layers_provided.html">... know which layers are provided?</a></li><li class="is-active"><a class="tocitem" href="mask_a_layer.html">... mask a layer?</a><ul class="internal"><li><a class="tocitem" href="#Using-nodata!"><span>Using <code>nodata!</code></span></a></li><li><a class="tocitem" href="#Using-mask!"><span>Using <code>mask!</code></span></a></li><li><a class="tocitem" href="#Related-documentation"><span>Related documentation</span></a></li><li><a class="tocitem" href="#A-note-about-how-this-works"><span>A note about how this works</span></a></li></ul></li><li><a class="tocitem" href="split_a_layer.html">... split a layer in tiles?</a></li><li><a class="tocitem" href="interpolate.html">... interpolate to a new projection?</a></li></ul></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../manual/SpeciesDistributionToolkit/index.html">Work with species occurrence data</a></li><li><a class="tocitem" href="../manual/SpeciesDistributionToolkit/gbif.jl.html">Occurrences and layers</a></li><li><a class="tocitem" href="../manual/SpeciesDistributionToolkit/pseudoabsences.html">Pseudo-absences</a></li></ul></li><li><span class="tocitem">Appendix: datasets</span><ul><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox"/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">BiodiversityMapping</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../datasets/BiodiversityMapping/AmphibianRichness.html">AmphibianRichness</a></li><li><a class="tocitem" href="../datasets/BiodiversityMapping/BirdRichness.html">BirdRichness</a></li><li><a class="tocitem" href="../datasets/BiodiversityMapping/MammalRichness.html">MammalRichness</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">CHELSA1</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../datasets/CHELSA1/AverageTemperature.html">AverageTemperature</a></li><li><a class="tocitem" href="../datasets/CHELSA1/BioClim.html">BioClim</a></li><li><a class="tocitem" href="../datasets/CHELSA1/MaximumTemperature.html">MaximumTemperature</a></li><li><a class="tocitem" href="../datasets/CHELSA1/MinimumTemperature.html">MinimumTemperature</a></li><li><a class="tocitem" href="../datasets/CHELSA1/Precipitation.html">Precipitation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">CHELSA2</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../datasets/CHELSA2/AverageTemperature.html">AverageTemperature</a></li><li><a class="tocitem" href="../datasets/CHELSA2/BioClim.html">BioClim</a></li><li><a class="tocitem" href="../datasets/CHELSA2/MaximumTemperature.html">MaximumTemperature</a></li><li><a class="tocitem" href="../datasets/CHELSA2/MinimumTemperature.html">MinimumTemperature</a></li><li><a class="tocitem" href="../datasets/CHELSA2/Precipitation.html">Precipitation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-4" type="checkbox"/><label class="tocitem" for="menuitem-5-4"><span class="docs-label">EarthEnv</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../datasets/EarthEnv/HabitatHeterogeneity.html">HabitatHeterogeneity</a></li><li><a class="tocitem" href="../datasets/EarthEnv/LandCover.html">LandCover</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-5" type="checkbox"/><label class="tocitem" for="menuitem-5-5"><span class="docs-label">PaleoClim</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../datasets/PaleoClim/BioClim.html">BioClim</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-6" type="checkbox"/><label class="tocitem" for="menuitem-5-6"><span class="docs-label">WorldClim2</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../datasets/WorldClim2/AverageTemperature.html">AverageTemperature</a></li><li><a class="tocitem" href="../datasets/WorldClim2/BioClim.html">BioClim</a></li><li><a class="tocitem" href="../datasets/WorldClim2/Elevation.html">Elevation</a></li><li><a class="tocitem" href="../datasets/WorldClim2/MaximumTemperature.html">MaximumTemperature</a></li><li><a class="tocitem" href="../datasets/WorldClim2/MinimumTemperature.html">MinimumTemperature</a></li><li><a class="tocitem" href="../datasets/WorldClim2/Precipitation.html">Precipitation</a></li><li><a class="tocitem" href="../datasets/WorldClim2/SolarRadiation.html">SolarRadiation</a></li><li><a class="tocitem" href="../datasets/WorldClim2/WaterVaporPressure.html">WaterVaporPressure</a></li><li><a class="tocitem" href="../datasets/WorldClim2/WindSpeed.html">WindSpeed</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">How-to...</a></li><li class="is-active"><a href="mask_a_layer.html">... mask a layer?</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="mask_a_layer.html">... mask a layer?</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/PoisotLab/SpeciesDistributionToolkit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/PoisotLab/SpeciesDistributionToolkit.jl/blob/main/docs/src/howto/mask_a_layer.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="...-mask-a-layer?"><a class="docs-heading-anchor" href="#...-mask-a-layer?">... mask a layer?</a><a id="...-mask-a-layer?-1"></a><a class="docs-heading-anchor-permalink" href="#...-mask-a-layer?" title="Permalink"></a></h1><p>The process of <em>masking</em> refers to turning cells on a layer&#39;s grid to <em>off</em>, which will result in them being excluded from the analysis/display.</p><p>There are two ways to mask a layer – using the <code>nodata!</code> approach, and using the <code>mask!</code> approach. We use <code>nodata!</code> when working from a single layer, and <code>mask!</code> when using data stored in a second layer. Note that both approaches have a non-mutating version (<code>nodata</code> and <code>mask</code>, that return a modified copy of their layer).</p><pre><code class="language-julia hljs">using SpeciesDistributionToolkit
using Dates, Statistics
using CairoMakie</code></pre><p>We will illustrate both approaches using the CHELSA2 temperature data for the month of September.</p><pre><code class="language-julia hljs">spatial_extent = (left = 8.412, bottom = 41.325, right = 9.662, top = 43.060)
temp2 =
    SDMLayer(
        RasterData(CHELSA2, AverageTemperature);
        month = Month(9),
        spatial_extent...,
    )</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SDM Layer with 31559 UInt16 cells
	Proj string: +proj=longlat +datum=WGS84 +no_defs
	Grid size: (209, 151)</code></pre><p><img src="mask-original.png" alt="Original layer"/></p><h2 id="Using-nodata!"><a class="docs-heading-anchor" href="#Using-nodata!">Using <code>nodata!</code></a><a id="Using-nodata!-1"></a><a class="docs-heading-anchor-permalink" href="#Using-nodata!" title="Permalink"></a></h2><p>When using <code>nodata!</code>, we can either indicate a value to remove from the layer, or pass a function. For example, we can mask the layer to remove all cells where the temperature is in the upper and lower 5%:</p><pre><code class="language-julia hljs">m, M = Statistics.quantile(values(temp2), [0.05, 0.95])
nodata(temp2, v -&gt; !(m &lt;= v &lt;= M))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SDM Layer with 28449 UInt16 cells
	Proj string: +proj=longlat +datum=WGS84 +no_defs
	Grid size: (209, 151)</code></pre><p><img src="mask-nodata.png" alt="mask with nodata"/></p><p>The function given as the second argument must return <code>true</code> for a point that will be excluded from the layer. In other words, this behaves as the <em>opposite</em> of <code>filter!</code>.</p><h2 id="Using-mask!"><a class="docs-heading-anchor" href="#Using-mask!">Using <code>mask!</code></a><a id="Using-mask!-1"></a><a class="docs-heading-anchor-permalink" href="#Using-mask!" title="Permalink"></a></h2><p>When using <code>mask!</code>, the first layer will be modified so that only the cells that are also valued in the second layer are used. For example, we can use the fact that the CHELSA1 layers do not have values outside of land, to mask the CHELSA2 data:</p><pre><code class="language-julia hljs">temp1 =
    SDMLayer(
        RasterData(CHELSA1, AverageTemperature);
        month = Month(9),
        spatial_extent...,
    )</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SDM Layer with 14432 Int16 cells
	Proj string: +proj=longlat +datum=WGS84 +no_defs
	Grid size: (209, 151)</code></pre><pre><code class="language-julia hljs">mask(temp2, temp1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SDM Layer with 14432 UInt16 cells
	Proj string: +proj=longlat +datum=WGS84 +no_defs
	Grid size: (209, 151)</code></pre><p><img src="mask-mask.png" alt="mask with mask"/></p><h2 id="Related-documentation"><a class="docs-heading-anchor" href="#Related-documentation">Related documentation</a><a id="Related-documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Related-documentation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SimpleSDMLayers.nodata!-howto-mask_a_layer" href="#SimpleSDMLayers.nodata!-howto-mask_a_layer"><code>SimpleSDMLayers.nodata!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nodata!(layer::SDMLayer{T}, nodata::T) where {T}</code></pre><p>Changes the value of the layer representing no data. This modifies the layer passed as its first argument.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PoisotLab/SpeciesDistributionToolkit.jl/blob/a608f90c984f0144025470b1192ea97dd352780e/SimpleSDMLayers/src/types.jl#L62-L67">source</a></section><section><div><pre><code class="language-julia hljs">nodata!(layer::SDMLayer{T}, f)</code></pre><p>Removes the data matching a function</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PoisotLab/SpeciesDistributionToolkit.jl/blob/a608f90c984f0144025470b1192ea97dd352780e/SimpleSDMLayers/src/types.jl#L83-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SimpleSDMLayers.nodata-howto-mask_a_layer" href="#SimpleSDMLayers.nodata-howto-mask_a_layer"><code>SimpleSDMLayers.nodata</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nodata(layer::SDMLayer, args...)</code></pre><p>Makes a copy and calls <code>nodata!</code> on it</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PoisotLab/SpeciesDistributionToolkit.jl/blob/a608f90c984f0144025470b1192ea97dd352780e/SimpleSDMLayers/src/types.jl#L108-L112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SimpleSDMLayers.mask!-howto-mask_a_layer" href="#SimpleSDMLayers.mask!-howto-mask_a_layer"><code>SimpleSDMLayers.mask!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mask!(layer::SDMLayer, template::SDMLayer)</code></pre><p>Updates the positions in the first layer to be those that have a value in the second layer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PoisotLab/SpeciesDistributionToolkit.jl/blob/a608f90c984f0144025470b1192ea97dd352780e/SimpleSDMLayers/src/mask.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SimpleSDMLayers.mask-howto-mask_a_layer" href="#SimpleSDMLayers.mask-howto-mask_a_layer"><code>SimpleSDMLayers.mask</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mask(layer::SDMLayer, template::SDMLayer)</code></pre><p>Returns a copy of the first layer masked according to the second layer. See also <code>mask!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PoisotLab/SpeciesDistributionToolkit.jl/blob/a608f90c984f0144025470b1192ea97dd352780e/SimpleSDMLayers/src/mask.jl#L16-L20">source</a></section></article><h2 id="A-note-about-how-this-works"><a class="docs-heading-anchor" href="#A-note-about-how-this-works">A note about how this works</a><a id="A-note-about-how-this-works-1"></a><a class="docs-heading-anchor-permalink" href="#A-note-about-how-this-works" title="Permalink"></a></h2><p>The <code>SDMLayer</code> type stores a <code>BitMatrix</code> (in the <code>indices</code> field) that tracks which cells in the raster are visible. This costs a little more memory, but allows to rapidly turn pixels on and off.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="know_layers_provided.html">« ... know which layers are provided?</a><a class="docs-footer-nextpage" href="split_a_layer.html">... split a layer in tiles? »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Friday 13 September 2024 14:14">Friday 13 September 2024</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
