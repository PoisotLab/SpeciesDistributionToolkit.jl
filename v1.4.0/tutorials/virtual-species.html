<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Generating virtual species | Species Distribution Toolkit</title>
    <meta name="description" content="Documentation for SpeciesDistributionToolkit.jl">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/SpeciesDistributionToolkit.jl/v1.4.0/assets/style.BRjtfxdV.css" as="style">
    <link rel="preload stylesheet" href="/SpeciesDistributionToolkit.jl/v1.4.0/vp-icons.css" as="style">
    
    <script type="module" src="/SpeciesDistributionToolkit.jl/v1.4.0/assets/app.Bfqg7U78.js"></script>
    <link rel="preload" href="/SpeciesDistributionToolkit.jl/v1.4.0/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/SpeciesDistributionToolkit.jl/v1.4.0/assets/chunks/theme.B08LE5sV.js">
    <link rel="modulepreload" href="/SpeciesDistributionToolkit.jl/v1.4.0/assets/chunks/framework.CmO0B0Vo.js">
    <link rel="modulepreload" href="/SpeciesDistributionToolkit.jl/v1.4.0/assets/tutorials_virtual-species.md.e10KV8Hs.lean.js">
    <link rel="icon" href="REPLACE_ME_DOCUMENTER_VITEPRESS_FAVICON">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/SpeciesDistributionToolkit.jl/v1.4.0/" data-v-0f4f798b><!--[--><!--]--><!--[--><img class="VPImage logo" src="/SpeciesDistributionToolkit.jl/v1.4.0/logo.svg" width="24" height="24" alt data-v-35a7d0b8><!--]--><span data-v-0f4f798b>Species Distribution Toolkit</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/SpeciesDistributionToolkit.jl/v1.4.0/index" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Index</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Manual</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/SpeciesDistributionToolkit.jl/v1.4.0/tutorials" data-v-acbfed09><!--[--><span data-v-acbfed09>Tutorials</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/SpeciesDistributionToolkit.jl/v1.4.0/howto" data-v-acbfed09><!--[--><span data-v-acbfed09>How-to</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/SpeciesDistributionToolkit.jl/v1.4.0/reference" data-v-acbfed09><!--[--><span data-v-acbfed09>Reference</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Datasets</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/SpeciesDistributionToolkit.jl/v1.4.0/datasets/BiodiversityMapping" data-v-acbfed09><!--[--><span data-v-acbfed09>BiodiversityMapping</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/SpeciesDistributionToolkit.jl/v1.4.0/datasets/CHELSA1" data-v-acbfed09><!--[--><span data-v-acbfed09>CHELSA 1</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/SpeciesDistributionToolkit.jl/v1.4.0/datasets/CHELSA2" data-v-acbfed09><!--[--><span data-v-acbfed09>CHELSA 2</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/SpeciesDistributionToolkit.jl/v1.4.0/datasets/Copernicus" data-v-acbfed09><!--[--><span data-v-acbfed09>Copernicus</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/SpeciesDistributionToolkit.jl/v1.4.0/datasets/EarthEnv" data-v-acbfed09><!--[--><span data-v-acbfed09>EarthEnv</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/SpeciesDistributionToolkit.jl/v1.4.0/datasets/PaleoClim" data-v-acbfed09><!--[--><span data-v-acbfed09>PaleoClim</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/SpeciesDistributionToolkit.jl/v1.4.0/datasets/WorldClim2" data-v-acbfed09><!--[--><span data-v-acbfed09>WorldClim 2</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Ecosystem</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Core packages</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link vp-external-link-icon" href="https://poisotlab.github.io/SpeciesDistributionToolkit.jl/OccurrencesInterface/" target="_blank" rel="noreferrer" data-v-acbfed09><!--[--><span data-v-acbfed09>OccurrencesInterface.jl</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link vp-external-link-icon" href="https://poisotlab.github.io/SpeciesDistributionToolkit.jl/GBIF/" target="_blank" rel="noreferrer" data-v-acbfed09><!--[--><span data-v-acbfed09>GBIF.jl</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link vp-external-link-icon" href="https://poisotlab.github.io/SpeciesDistributionToolkit.jl/Phylopic/" target="_blank" rel="noreferrer" data-v-acbfed09><!--[--><span data-v-acbfed09>Phylopic.jl</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link vp-external-link-icon" href="https://poisotlab.github.io/SpeciesDistributionToolkit.jl/Fauxcurrences/" target="_blank" rel="noreferrer" data-v-acbfed09><!--[--><span data-v-acbfed09>Fauxcurrences.jl</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link vp-external-link-icon" href="https://poisotlab.github.io/SpeciesDistributionToolkit.jl/SimpleSDMLayers/" target="_blank" rel="noreferrer" data-v-acbfed09><!--[--><span data-v-acbfed09>SimpleSDMLayers.jl</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link vp-external-link-icon" href="https://poisotlab.github.io/SpeciesDistributionToolkit.jl/SimpleSDMDatasets/" target="_blank" rel="noreferrer" data-v-acbfed09><!--[--><span data-v-acbfed09>SimpleSDMDatasets.jl</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link vp-external-link-icon" href="https://poisotlab.github.io/SpeciesDistributionToolkit.jl/SDeMo/" target="_blank" rel="noreferrer" data-v-acbfed09><!--[--><span data-v-acbfed09>SDeMo.jl</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Packages we support</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link vp-external-link-icon" href="https://poisotlab.github.io/BiodiversityObservationNetworks.jl/dev/" target="_blank" rel="noreferrer" data-v-acbfed09><!--[--><span data-v-acbfed09>BON.jl</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link vp-external-link-icon" href="https://juliaclimate.github.io/STAC.jl/dev/" target="_blank" rel="noreferrer" data-v-acbfed09><!--[--><span data-v-acbfed09>STAC.jl</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link vp-external-link-icon" href="https://poisotlab.github.io/SpatialBoundaries.jl/dev/" target="_blank" rel="noreferrer" data-v-acbfed09><!--[--><span data-v-acbfed09>SpatialBoundaries.jl</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link vp-external-link-icon" href="https://docs.ecojulia.org/NeutralLandscapes.jl/dev/" target="_blank" rel="noreferrer" data-v-acbfed09><!--[--><span data-v-acbfed09>NeutralLandscapes.jl</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link vp-external-link-icon" href="https://juliastats.org/Clustering.jl/stable/" target="_blank" rel="noreferrer" data-v-acbfed09><!--[--><span data-v-acbfed09>Clustering.jl</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/PoisotLab/SpeciesDistributionToolkit.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/PoisotLab/SpeciesDistributionToolkit.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Tutorials</h2><!----></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/SpeciesDistributionToolkit.jl/v1.4.0/tutorials/climatenovelty/" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Calculating climate novelty</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/SpeciesDistributionToolkit.jl/v1.4.0/tutorials/bioclim/" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Building the BIOCLIM model</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/SpeciesDistributionToolkit.jl/v1.4.0/tutorials/consensus/" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Generating a landcover consensus</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/SpeciesDistributionToolkit.jl/v1.4.0/tutorials/fauxcurrences/" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Generating fauxcurrences</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/SpeciesDistributionToolkit.jl/v1.4.0/tutorials/virtual-species/" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Generating virtual species</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/SpeciesDistributionToolkit.jl/v1.4.0/tutorials/spatial-boundaries/" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Identifying spatial boundaries</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/SpeciesDistributionToolkit.jl/v1.4.0/tutorials/sdemo-introduction/" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Training SDMs with SDeMo</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/SpeciesDistributionToolkit.jl/v1.4.0/tutorials/sdemo-vignette/" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Mapping SDMs with SDeMo</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _SpeciesDistributionToolkit_jl_v1_4_0_tutorials_virtual-species" data-v-83890dd9><div><h1 id="Generating-virtual-species" tabindex="-1">Generating virtual species <a class="header-anchor" href="#Generating-virtual-species" aria-label="Permalink to &quot;Generating virtual species {#Generating-virtual-species}&quot;">​</a></h1><p>In this vignette, we provide a demonstration of how the different SpeciesDistributionToolkit functions can be chained together to rapidly create a virtual species, generate its range map, and sample points from it according to the predicted suitability.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">using</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> SpeciesDistributionToolkit</span></span>
<span class="line"><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">using</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> CairoMakie</span></span>
<span class="line"><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">using</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> Statistics</span></span></code></pre></div><p>We start by defining the extent in which we want to create the virtual species. For the purpose of this example, we will use the country of Paraguay, a polygon of which is available in the GADM database. Note that the boundingbox function returns the coordinates in WGS84.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">place </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> SpeciesDistributionToolkit</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">.</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">gadm</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(</span><span style="--shiki-light:#DFA000;--shiki-dark:#DBBC7F;">&quot;PRY&quot;</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">extent </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> SpeciesDistributionToolkit</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">.</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">boundingbox</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(place)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span>(left = -62.642398834228516, right = -54.25859832763672, bottom = -27.60569953918457, top = -19.29520034790039)</span></span></code></pre></div><p>We then download some environmental data. In this example, we use the BioClim variables as distributed by CHELSA. In order to simplify the code, we will only use BIO1 (mean annual temperature) and BIO12 (total annual precipitation). Note that we collect these layers in a vector typed as SDMLayer{Float32}, in order to ensure that future operations already recevie floating point values.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">provider </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> RasterData</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(CHELSA2, BioClim)</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">L </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> SDMLayer{Float32}[</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">SDMLayer</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(provider; layer</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">l, extent</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">...</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">) </span><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">for</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> l </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">in</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> [</span><span style="--shiki-light:#DFA000;--shiki-dark:#DBBC7F;">&quot;BIO1&quot;</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">, </span><span style="--shiki-light:#DFA000;--shiki-dark:#DBBC7F;">&quot;BIO12&quot;</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">]]</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span>2-element Vector{SDMLayer{Float32}}:</span></span>
<span class="line"><span> 🗺️  A 998 × 1007 layer (1004986 Float32 cells)</span></span>
<span class="line"><span> 🗺️  A 998 × 1007 layer (1004986 Float32 cells)</span></span></code></pre></div><p>We now mask the layers using the polygons we downloaded initially. Here, this is done in two steps, first the masking of the first layer, and second the masking of all other layers. Currently unreleased versions of the package have a shortcut for this operation.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">rescale!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">.(</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">mask!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(L, place))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span>2-element Vector{SDMLayer{Float32}}:</span></span>
<span class="line"><span> 🗺️  A 998 × 1007 layer (507665 Float32 cells)</span></span>
<span class="line"><span> 🗺️  A 998 × 1007 layer (507665 Float32 cells)</span></span></code></pre></div><p>In the next steps, we will generate some virtual species. These are defined by an environmental response to each layer, linking the value of the layer at a point to the suitability score. For the sake of expediency, we only use logistic responses, and generate one function for each layer (drawing α from a normal distribution, and β uniformly).</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">logistic</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(x, α, β) </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;"> 1</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;"> /</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> (</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;"> +</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> exp</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">((x</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">-</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">β)</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">/</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">α))</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">logistic</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(α, β) </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> (x) </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">-&gt;</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> logistic</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(x, α, β)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span>logistic (generic function with 2 methods)</span></span></code></pre></div><p>We will next write a function that will sample a value in each layer to serve as the center of the logistic response, draw a shape parameter at random, and then return the suitability of the environment for a virtual species under the assumption of a set prevalence:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">function</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> virtualspecies</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(L</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">::</span><span style="--shiki-light:#3A94C5;--shiki-dark:#7FBBB3;">Vector{&lt;:SDMLayer}</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">; prevalence</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">::</span><span style="--shiki-light:#3A94C5;--shiki-dark:#7FBBB3;">Float64</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;"> =</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;"> 0.25</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    prevalence </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> clamp</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(prevalence, </span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">eps</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(), </span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1.0</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    invalid </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#35A77C;--shiki-dark:#83C092;"> true</span></span>
<span class="line"><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">    while</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> invalid</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">        centers </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> [</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">rand</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">values</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(l)) </span><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">for</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> l </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">in</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> L]</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">        shapes </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> randn</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">length</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(L))</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">        predictors </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> [</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">logistic</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(centers[i], shapes[i]) </span><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">for</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> i </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">in</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> eachindex</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(L)]</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">        predictions </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> [predictors[i]</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">.</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(L[i]) </span><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">for</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> i </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">in</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> eachindex</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(L)]</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">        rescale!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">.(predictions)</span></span>
<span class="line"><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">        global</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> prediction </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> prod</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(predictions)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">        rescale!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(prediction)</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">        invalid </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> any</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(isnan, prediction)</span></span>
<span class="line"><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">    end</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    cutoff </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> quantile</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(prediction, </span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">-</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">prevalence)</span></span>
<span class="line"><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">    return</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> prediction, cutoff, prediction </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">.&gt;=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> cutoff</span></span>
<span class="line"><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span>virtualspecies (generic function with 1 method)</span></span></code></pre></div><p>We can now apply this new function to create a simulated species distribution:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">vsp, τ, vrng </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> virtualspecies</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(L; prevalence</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">0.33</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span>(🗺️  A 998 × 1007 layer (507665 Float64 cells), 0.5629265858496739, 🗺️  A 998 × 1007 layer (507665 Bool cells))</span></span></code></pre></div><p>We can plot the output of this function to inspect what the generated range looks like:</p><p><img src="/SpeciesDistributionToolkit.jl/v1.4.0/assets/13306679281701674523-virtualspeciescomparison.Db5pfe8M.png" alt=""></p><details class="details custom-block"><summary>Code for the figure</summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">f </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> Figure</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(size</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">700</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">, </span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">700</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">))</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">ax1 </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> Axis</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(f[</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">,</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">]; aspect</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">DataAspect</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(), title</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#DFA000;--shiki-dark:#DBBC7F;">&quot;Score&quot;</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">ax2 </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> Axis</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(f[</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">,</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">2</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">]; aspect</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">DataAspect</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(), title</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#DFA000;--shiki-dark:#DBBC7F;">&quot;Range&quot;</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">heatmap!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax1, vsp, colormap</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">:navia)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">heatmap!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax2, vrng, colormap</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">:Greens)</span></span>
<span class="line"><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">for</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> ax </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">in</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> [ax1, ax2]</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">    tightlimits!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">    hidedecorations!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">    hidespines!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">    lines!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax, place[</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">]</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">.</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">geometry, color</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">:black)</span></span>
<span class="line"><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">end</span></span></code></pre></div></details><p>Random observations for the virtual species are generated by setting the probability of inclusion to 0 for all values above the cutoff, and then sampling proportionally to the suitability for all remaining points. Note that the method is called backgroundpoints, as it is normally used for pseudo-absences. The second argument of this method is the number of points to generate.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">presencelayer </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> backgroundpoints</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">mask</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(vsp, </span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">nodata</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(vrng, </span><span style="--shiki-light:#35A77C;--shiki-dark:#83C092;">false</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)), </span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">100</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span>🗺️  A 998 × 1007 layer with 167530 Bool cells</span></span>
<span class="line"><span>   Projection: +proj=longlat +datum=WGS84 +no_defs</span></span></code></pre></div><p>We can finally plot the result:</p><p><img src="/SpeciesDistributionToolkit.jl/v1.4.0/assets/13306679281701674523-virtualspeciessample.CDgdTOIj.png" alt=""></p><details class="details custom-block"><summary>Code for the figure</summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">f </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> Figure</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(size</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">700</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">, </span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">700</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">))</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">ax </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> Axis</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(f[</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">,</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">], aspect</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">DataAspect</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">())</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">heatmap!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax, vrng, colormap</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">:Greens)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">lines!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax, place[</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">]</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">.</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">geometry, color</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">:black)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">scatter!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax, presencelayer, color</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">:white, strokecolor</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">:black, strokewidth</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">2</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">, markersize</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">10</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">, label</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#DFA000;--shiki-dark:#DBBC7F;">&quot;Virtual presences&quot;</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">tightlimits!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">hidespines!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">hidedecorations!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">axislegend</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax, position</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">:lb, framevisible</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#35A77C;--shiki-dark:#83C092;">false</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span></span></code></pre></div></details><p>These data could, for example, be used to benchmark species distribution models. For the analysis presented in the manuscript, we are interested in applying the simulation of virtual species to a large number, in order to say something about potential patterns of biodiversity. For this reason, we will now simulate 100 species, with prevalences drawn uniformly in the unit interval.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">ranges </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> [</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">virtualspecies</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(L; prevalence</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">rand</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">())[</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">3</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">] </span><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">for</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> _ </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">in</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;"> 1</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">:</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">100</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">]</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">first</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ranges)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span>🗺️  A 998 × 1007 layer with 507665 Bool cells</span></span>
<span class="line"><span>   Projection: +proj=longlat +datum=WGS84 +no_defs</span></span></code></pre></div><p>We can sum these layers to obtain a measurement of the simulated species richness:</p><p><img src="/SpeciesDistributionToolkit.jl/v1.4.0/assets/13306679281701674523-virtualspeciesrichness.BST0ZH0b.png" alt=""></p><details class="details custom-block"><summary>Code for the figure</summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">f </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> Figure</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">()</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">richness </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> mosaic</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(sum, ranges)</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">ax </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> Axis</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(f[</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">,</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">]; aspect</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">DataAspect</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">())</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">hm </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> heatmap!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax, richness, colorrange</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">0</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">, </span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">length</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ranges)), colormap</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">:navia)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">Colorbar</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(f[</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">,</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">], hm, label</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#DFA000;--shiki-dark:#DBBC7F;">&quot;Species richness&quot;</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">, alignmode</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">Inside</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(), width</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">Relative</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">0.4</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">), valign</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">:bottom, halign</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">:left, tellheight</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#35A77C;--shiki-dark:#83C092;">false</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">, tellwidth</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#35A77C;--shiki-dark:#83C092;">false</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">, vertical</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#35A77C;--shiki-dark:#83C092;">false</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">hidedecorations!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">lines!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax, place[</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">]</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">.</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">geometry, color</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">:black)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">hidespines!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax)</span></span></code></pre></div></details><p>We can now transform these data into a partition of the contribution of each species and location to the total beta-diversity:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">function</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> LCBD</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ranges</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">::</span><span style="--shiki-light:#3A94C5;--shiki-dark:#7FBBB3;">Vector{SDMLayer{Bool}}</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">; transformation</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">::</span><span style="--shiki-light:#3A94C5;--shiki-dark:#7FBBB3;">Function</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">identity)</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    Y </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> transformation</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">hcat</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">values</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">.(ranges)</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">...</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">))</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    S </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> (Y </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">.-</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> mean</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(Y; dims</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">))</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">.^</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">2.0</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    SStotal </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> sum</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(S)</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    BDtotal </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> SStotal </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">/</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> (</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">size</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(Y,</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">-</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    SSj </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> sum</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(S; dims</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    SCBDj </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> SSj </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">./</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> SStotal</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    SSi </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> sum</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(S; dims</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">2</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    LCBDi </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> SSi </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">./</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> SStotal</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    betadiv </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> similar</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">first</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ranges), Float32)</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    betadiv</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">.</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">grid[</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">findall</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(betadiv</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">.</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">indices)] .</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> vec</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(LCBDi)</span></span>
<span class="line"><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">    return</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> betadiv, </span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">vec</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(SCBDj), BDtotal</span></span>
<span class="line"><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span>LCBD (generic function with 1 method)</span></span></code></pre></div><p>For good measure, we will also add a function to perform the Hellinger transformation:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">function</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> hellinger</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(Y</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">::</span><span style="--shiki-light:#3A94C5;--shiki-dark:#7FBBB3;">AbstractMatrix{T}</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">) </span><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">where</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> {T </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">&lt;:</span><span style="--shiki-light:#3A94C5;--shiki-dark:#7FBBB3;"> Number</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">}</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    yi </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> sum</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(Y; dims</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">2</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">) </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">.+</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;"> 1</span></span>
<span class="line"><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">    return</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> sqrt</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">.(Y </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">./</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;"> yi)</span></span>
<span class="line"><span style="--shiki-light:#F85552;--shiki-dark:#E67E80;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span>hellinger (generic function with 1 method)</span></span></code></pre></div><p>We can now apply this function to our simulated ranges. The first output is a layer with the local contributions to beta diversity (LCBD), the second is a vector with the contribution of species, and the last element is the total beta diversity.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">βl, βs, βt </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> LCBD</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ranges; transformation</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">hellinger)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span>(🗺️  A 998 × 1007 layer (507665 Float32 cells), [0.0054826943543899685, 0.006540383955041101, 0.009472688070267982, 0.026048045152999622, 0.012922237726253769, 0.01174233427898983, 0.011330414532912786, 0.011091930224798626, 0.015914260226827043, 0.001431345603684186, 0.009007189617871864, 0.0032932904651917587, 0.010581856979069194, 0.007844490074970909, 0.011480575469831509, 0.008355502205900624, 0.0070827849757694895, 0.008785963108297745, 0.003956879539947737, 0.011188204398235221, 0.01231257024234039, 0.008750836249786292, 0.011751259683015991, 0.007189668354559299, 0.010847065086487893, 0.006683182464172225, 0.0022997251805346812, 0.01118870910845903, 0.00722908327640435, 0.01503319641621985, 0.006198652126851622, 0.013006115473833018, 0.02624844280812432, 0.014352514197906115, 0.008814224756622342, 0.013448454596086873, 0.015500327597050736, 0.011387933851229175, 0.013123485385448106, 0.0068066502415425004, 0.012245159877793819, 0.00864965614942691, 0.002135118597995631, 0.011845302096041023, 0.011959132304958011, 0.00896228578313248, 0.008466700345101004, 0.011990253702221492, 0.011097465089560806, 0.011158300598466626, 0.0010258006258311596, 0.011519591561618756, 0.006397977633500228, 0.012703733078379973, 0.01085196070707093, 0.007688233525896908, 0.02605398377226555, 0.013853127723288953, 0.009963486054729265, 0.011891493591597501, 0.012286334550330992, 0.011149158273097494, 0.012890161168802667, 0.007595443314122404, 0.008674330220422972, 0.007099851767174225, 0.0019082076429426736, 0.010329547077669038, 0.008260151767293458, 0.010202818392689784, 0.012414020473182517, 0.006348021151399296, 0.01050759829902877, 0.010185948648569415, 0.011511144845407674, 0.011320795527565953, 0.008813890345772978, 0.006559921309613978, 0.011280332969856262, 0.011717431170481308, 0.011487464515760123, 0.016760308154960046, 0.007863935040548786, 0.010725890777183295, 0.001003934579789032, 0.011843851771899734, 0.010462129462864869, 0.011288974991593462, 0.011923372437986128, 0.007929019929417363, 0.002488884134708335, 0.008494837952984712, 0.010488905069436996, 0.01332492498569968, 0.006339750982758879, 0.014846270497575934, 0.011198118148432164, 0.0065278935166706775, 0.0014190820923391067, 0.006343411165164069], 0.2972863986538144)</span></span></code></pre></div><p>We can now plot the various elements (most of the code below is actually laying out the sub-panels for the plot):</p><p><img src="/SpeciesDistributionToolkit.jl/v1.4.0/assets/13306679281701674523-betadivmap.DzGrzL6L.png" alt=""></p><details class="details custom-block"><summary>Code for the figure</summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes everforest-light everforest-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">f </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> Figure</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(size</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">700</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">, </span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">700</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">))</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">ax </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> Axis</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(f[</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">,</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">], aspect</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">DataAspect</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">())</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">hm </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> heatmap!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax, (βl </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">-</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> mean</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(βl))</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">/</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">std</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(βl), colormap</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">Reverse</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(:RdYlBu), colorrange</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">-</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">2</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">, </span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">2</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">))</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">lines!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax, place[</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">]</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">.</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">geometry, color</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">:black)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">Colorbar</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(f[</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">,</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">], hm, label</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#DFA000;--shiki-dark:#DBBC7F;">&quot;Normalized LCBD&quot;</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">, alignmode</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">Inside</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(), width</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">Relative</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">0.4</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">), valign</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">:bottom, halign</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">:left, tellheight</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#35A77C;--shiki-dark:#83C092;">false</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">, tellwidth</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#35A77C;--shiki-dark:#83C092;">false</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">, vertical</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#35A77C;--shiki-dark:#83C092;">false</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">tightlimits!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">hidespines!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">hidedecorations!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax)</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">ax_inset </span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;"> Axis</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(f[</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">, </span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">],</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    width</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">Relative</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">0.36</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">),</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    height</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">Relative</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">0.1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">),</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    halign</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1.0</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">,</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    valign</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">0.9</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">,</span></span>
<span class="line"><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">    xlabel</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#DFA000;--shiki-dark:#DBBC7F;">&quot;Rel. SCBD&quot;</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">hist!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax_inset, βs</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">./</span><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">maximum</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(βs), color</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">:lightgrey, bins</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">40</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">xlims!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax_inset, </span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">0</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">, </span><span style="--shiki-light:#DF69BA;--shiki-dark:#D699B6;">1</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">hidespines!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax_inset, :t, :r, :l)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">hideydecorations!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax_inset)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">hidexdecorations!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax_inset, ticks</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#35A77C;--shiki-dark:#83C092;">false</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">, ticklabels</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#35A77C;--shiki-dark:#83C092;">false</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">, label</span><span style="--shiki-light:#F57D26;--shiki-dark:#E69875;">=</span><span style="--shiki-light:#35A77C;--shiki-dark:#83C092;">false</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">)</span></span>
<span class="line"><span style="--shiki-light:#8DA101;--shiki-dark:#A7C080;">tightlimits!</span><span style="--shiki-light:#5C6A72;--shiki-dark:#D3C6AA;">(ax_inset)</span></span></code></pre></div></details></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/PoisotLab/SpeciesDistributionToolkit.jl/edit/main/docs/src/tutorials/virtual-species.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page<!--]--></a></div><!----></div><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://luxdl.github.io/DocumenterVitepress.jl/dev/" target="_blank"><strong>DocumenterVitepress.jl</strong></a> by the <a href="https://poisotlab.io/" target="_blank">Computational Ecology Research Group</a><br></p><p class="copyright" data-v-c970a860>This documentation is released under the <a href="https://creativecommons.org/licenses/by/4.0/deed.en" target="_blank">CC-BY 4.0 licence</a> - 2025</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"datasets_biodiversitymapping.md\":\"knuaYRAC\",\"datasets_chelsa1.md\":\"DY3YHZ1H\",\"datasets_chelsa2.md\":\"s7g1FpCV\",\"datasets_copernicus.md\":\"q9KseoqT\",\"datasets_earthenv.md\":\"Pxc5Oy7F\",\"datasets_paleoclim.md\":\"DQvzpUGc\",\"datasets_worldclim2.md\":\"t8LF9yGz\",\"howto_cluster-layers.md\":\"zqFafB6D\",\"howto_get-boundingbox.md\":\"DMmD4ndu\",\"howto_get-gbif-data.md\":\"9dYJ5IH-\",\"howto_index.md\":\"DjEiQa5P\",\"howto_interpolate.md\":\"DDqHr88R\",\"howto_layer-arithmetic.md\":\"DqOYuLKF\",\"howto_layer-occurrences.md\":\"D-_-kRRI\",\"howto_layer-statistics.md\":\"89cAi3oq\",\"howto_list-provided-layers.md\":\"DpEcJYcL\",\"howto_logistic-regression.md\":\"9dODi_BN\",\"howto_makie.md\":\"BjpVcQ63\",\"howto_mask-layer.md\":\"rII7yv5T\",\"howto_mask-polygons.md\":\"DVXwgp2p\",\"howto_neutral-landscapes.md\":\"BiwChxKv\",\"howto_pseudoabsences.md\":\"CRHRBpVU\",\"howto_read-part-layer.md\":\"COdFPRgC\",\"howto_split-layer.md\":\"DiAPcwS9\",\"howto_stac.md\":\"IrY0G9V9\",\"howto_zonal-statistics.md\":\"CavMKy5G\",\"index.md\":\"Dye9mFxI\",\"manual.md\":\"CQAZJmex\",\"reference_changelog.md\":\"CBrfAavd\",\"reference_code-of-conduct.md\":\"CuHyaqLA\",\"reference_contributing.md\":\"-d6iHopU\",\"reference_datasets_changelog.md\":\"deNyA3le\",\"reference_datasets_index.md\":\"CJr3b4GM\",\"reference_datasets_interface.md\":\"CwwQtIxH\",\"reference_datasets_internals.md\":\"K84AYxBG\",\"reference_datasets_types.md\":\"Dj56iVjr\",\"reference_fauxcurrences_changelog.md\":\"BrOL8N_A\",\"reference_fauxcurrences_index.md\":\"BShFER-H\",\"reference_gbif_changelog.md\":\"DGQYIaPa\",\"reference_gbif_data.md\":\"DSjKk_EY\",\"reference_gbif_enumerated.md\":\"ThqieeGy\",\"reference_gbif_index.md\":\"BguhNmqh\",\"reference_gbif_internals.md\":\"jA6bx_9y\",\"reference_gbif_types.md\":\"DjTT5f0P\",\"reference_index.md\":\"OkPSzE_E\",\"reference_integration_gadm.md\":\"CB1on_HS\",\"reference_integration_gbif.jl.md\":\"ChfILzgz\",\"reference_integration_polygons.md\":\"uBrN_l7n\",\"reference_integration_pseudoabsences.md\":\"DYPHHB2g\",\"reference_integration_utilities.md\":\"oJ-E3YiE\",\"reference_layers_changelog.md\":\"DjKyFJLn\",\"reference_layers_index.md\":\"BvkiYs1q\",\"reference_layers_operations.md\":\"DfORB9kP\",\"reference_layers_types.md\":\"Bww0QU1G\",\"reference_occint_changelog.md\":\"DK1HI2jj\",\"reference_occint_index.md\":\"BpAmlc7O\",\"reference_phylopic_changelog.md\":\"ukrDyGLn\",\"reference_phylopic_index.md\":\"8Jl_szc5\",\"reference_sdemo_changelog.md\":\"DUMJipr6\",\"reference_sdemo_crossvalidation.md\":\"CA9zwKbm\",\"reference_sdemo_ensembles.md\":\"DZnoEpxp\",\"reference_sdemo_explanations.md\":\"CN-o9Ozs\",\"reference_sdemo_features.md\":\"Bb2-iUJW\",\"reference_sdemo_index.md\":\"B3bSJIuq\",\"reference_sdemo_models.md\":\"6UgQXwnM\",\"reference_sdemo_saving.md\":\"BZIrn8fL\",\"reference_sdt_gadm.md\":\"6zI0PsQ7\",\"reference_sdt_gbif.md\":\"hkgmpRkv\",\"reference_sdt_polygons.md\":\"eeGSvtVM\",\"reference_sdt_pseudoabsences.md\":\"B0KtdCFl\",\"reference_sdt_utilities.md\":\"BlMqw5VU\",\"tutorials_bioclim.md\":\"Bf_Alih2\",\"tutorials_climatenovelty.md\":\"QCXnZeNa\",\"tutorials_consensus.md\":\"CmDIJPZy\",\"tutorials_fauxcurrences.md\":\"BsfPjLhl\",\"tutorials_index.md\":\"BsZf1Ssu\",\"tutorials_sdemo-introduction.md\":\"CFKH0h9O\",\"tutorials_sdemo-vignette.md\":\"BCMrVtPa\",\"tutorials_spatial-boundaries.md\":\"DPpZ7id6\",\"tutorials_virtual-species.md\":\"e10KV8Hs\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Species Distribution Toolkit\",\"description\":\"Documentation for SpeciesDistributionToolkit.jl\",\"base\":\"/SpeciesDistributionToolkit.jl/v1.4.0/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"docFooter\":{\"next\":false,\"prev\":false},\"logo\":{\"src\":\"/logo.svg\",\"width\":24,\"height\":24},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Index\",\"link\":\"/index\"},{\"text\":\"Manual\",\"items\":[{\"text\":\"Tutorials\",\"link\":\"/tutorials\"},{\"text\":\"How-to\",\"link\":\"/howto\"},{\"text\":\"Reference\",\"link\":\"/reference\"}]},{\"text\":\"Datasets\",\"items\":[{\"text\":\"BiodiversityMapping\",\"link\":\"/datasets/BiodiversityMapping\"},{\"text\":\"CHELSA 1\",\"link\":\"/datasets/CHELSA1\"},{\"text\":\"CHELSA 2\",\"link\":\"/datasets/CHELSA2\"},{\"text\":\"Copernicus\",\"link\":\"/datasets/Copernicus\"},{\"text\":\"EarthEnv\",\"link\":\"/datasets/EarthEnv\"},{\"text\":\"PaleoClim\",\"link\":\"/datasets/PaleoClim\"},{\"text\":\"WorldClim 2\",\"link\":\"/datasets/WorldClim2\"}]},{\"text\":\"Ecosystem\",\"items\":[{\"text\":\"Core packages\",\"items\":[{\"text\":\"OccurrencesInterface.jl\",\"link\":\"https://poisotlab.github.io/SpeciesDistributionToolkit.jl/OccurrencesInterface/\"},{\"text\":\"GBIF.jl\",\"link\":\"https://poisotlab.github.io/SpeciesDistributionToolkit.jl/GBIF/\"},{\"text\":\"Phylopic.jl\",\"link\":\"https://poisotlab.github.io/SpeciesDistributionToolkit.jl/Phylopic/\"},{\"text\":\"Fauxcurrences.jl\",\"link\":\"https://poisotlab.github.io/SpeciesDistributionToolkit.jl/Fauxcurrences/\"},{\"text\":\"SimpleSDMLayers.jl\",\"link\":\"https://poisotlab.github.io/SpeciesDistributionToolkit.jl/SimpleSDMLayers/\"},{\"text\":\"SimpleSDMDatasets.jl\",\"link\":\"https://poisotlab.github.io/SpeciesDistributionToolkit.jl/SimpleSDMDatasets/\"},{\"text\":\"SDeMo.jl\",\"link\":\"https://poisotlab.github.io/SpeciesDistributionToolkit.jl/SDeMo/\"}]},{\"text\":\"Packages we support\",\"items\":[{\"text\":\"BON.jl\",\"link\":\"https://poisotlab.github.io/BiodiversityObservationNetworks.jl/dev/\"},{\"text\":\"STAC.jl\",\"link\":\"https://juliaclimate.github.io/STAC.jl/dev/\"},{\"text\":\"SpatialBoundaries.jl\",\"link\":\"https://poisotlab.github.io/SpatialBoundaries.jl/dev/\"},{\"text\":\"NeutralLandscapes.jl\",\"link\":\"https://docs.ecojulia.org/NeutralLandscapes.jl/dev/\"},{\"text\":\"Clustering.jl\",\"link\":\"https://juliastats.org/Clustering.jl/stable/\"}]}]}],\"sidebar\":{\"/howto/\":[{\"text\":\"How-to...\",\"items\":[{\"text\":\"... get GBIF data?\",\"link\":\"/howto/get-gbif-data/\"},{\"text\":\"... interpolate data?\",\"link\":\"/howto/interpolate/\"},{\"text\":\"... list provided layers?\",\"link\":\"/howto/list-provided-layers/\"},{\"text\":\"... do arithmetic on layers?\",\"link\":\"/howto/layer-arithmetic/\"},{\"text\":\"... mask a layer?\",\"link\":\"/howto/mask-layer/\"},{\"text\":\"... mask with polygons?\",\"link\":\"/howto/mask-polygons/\"},{\"text\":\"... read part of a layer?\",\"link\":\"/howto/read-part-layer/\"},{\"text\":\"... get the bounding box for an object?\",\"link\":\"/howto/get-boundingbox/\"},{\"text\":\"... calculate statistics on layers?\",\"link\":\"/howto/layer-statistics/\"},{\"text\":\"... calculate zonal statistics?\",\"link\":\"/howto/zonal-statistics/\"},{\"text\":\"... generate pseudo-absences?\",\"link\":\"/howto/pseudoabsences/\"},{\"text\":\"... tweak logistic regression?\",\"link\":\"/howto/logistic-regression/\"},{\"text\":\"... split a layer in tiles?\",\"link\":\"/howto/split-layer/\"},{\"text\":\"... plot using Makie?\",\"link\":\"/howto/makie/\"},{\"text\":\"... get data from STAC?\",\"link\":\"/howto/stac/\"},{\"text\":\"... cluster layers?\",\"link\":\"/howto/cluster-layers/\"},{\"text\":\"... create neutral landscapes?\",\"link\":\"/howto/neutral-landscapes/\"},{\"text\":\"... index layers by occurrences?\",\"link\":\"/howto/layer-occurrences/\"}]}],\"/tutorials/\":[{\"text\":\"Tutorials\",\"items\":[{\"text\":\"Calculating climate novelty\",\"link\":\"/tutorials/climatenovelty/\"},{\"text\":\"Building the BIOCLIM model\",\"link\":\"/tutorials/bioclim/\"},{\"text\":\"Generating a landcover consensus\",\"link\":\"/tutorials/consensus/\"},{\"text\":\"Generating fauxcurrences\",\"link\":\"/tutorials/fauxcurrences/\"},{\"text\":\"Generating virtual species\",\"link\":\"/tutorials/virtual-species/\"},{\"text\":\"Identifying spatial boundaries\",\"link\":\"/tutorials/spatial-boundaries/\"},{\"text\":\"Training SDMs with SDeMo\",\"link\":\"/tutorials/sdemo-introduction/\"},{\"text\":\"Mapping SDMs with SDeMo\",\"link\":\"/tutorials/sdemo-vignette/\"}]}],\"/reference/\":[{\"text\":\"SpeciesDistributionToolkit\",\"collapsed\":true,\"items\":[{\"text\":\"Documentation\",\"link\":\"/reference/\"},{\"text\":\"GADM\",\"link\":\"/reference/sdt/gadm/\"},{\"text\":\"Polygons\",\"link\":\"/reference/sdt/gadm/\"},{\"text\":\"Pseudoabsences\",\"link\":\"/reference/sdt/pseudoabsences/\"},{\"text\":\"GBIF\",\"link\":\"/reference/sdt/gbif/\"},{\"text\":\"Changelog\",\"link\":\"/reference/CHANGELOG/\"}]},{\"text\":\"GBIF\",\"collapsed\":true,\"items\":[{\"text\":\"Documentation\",\"link\":\"/reference/gbif/\"},{\"text\":\"Types\",\"link\":\"/reference/gbif/types/\"},{\"text\":\"Data\",\"link\":\"/reference/gbif/data/\"},{\"text\":\"Enumerated values\",\"link\":\"/reference/gbif/enumerated/\"},{\"text\":\"Internals\",\"link\":\"/reference/gbif/internals/\"},{\"text\":\"Changelog\",\"link\":\"/reference/gbif/CHANGELOG/\"}]},{\"text\":\"OccurrencesInterface\",\"collapsed\":true,\"items\":[{\"text\":\"Documentation\",\"link\":\"/reference/occint/\"},{\"text\":\"Changelog\",\"link\":\"/reference/occint/CHANGELOG/\"}]},{\"text\":\"Phylopic\",\"collapsed\":true,\"items\":[{\"text\":\"Documentation\",\"link\":\"/reference/phylopic/\"},{\"text\":\"Changelog\",\"link\":\"/reference/phylopic/CHANGELOG/\"}]},{\"text\":\"Fauxcurrences\",\"collapsed\":true,\"items\":[{\"text\":\"Documentation\",\"link\":\"/reference/fauxcurrences/\"},{\"text\":\"Changelog\",\"link\":\"/reference/fauxcurrences/CHANGELOG/\"}]},{\"text\":\"SDeMo\",\"collapsed\":true,\"items\":[{\"text\":\"Documentation\",\"link\":\"/reference/sdemo/\"},{\"text\":\"Models\",\"link\":\"/reference/sdemo/models/\"},{\"text\":\"Ensembles\",\"link\":\"/reference/sdemo/ensembles/\"},{\"text\":\"Saving\",\"link\":\"/reference/sdemo/saving/\"},{\"text\":\"Cross-validation\",\"link\":\"/reference/sdemo/crossvalidation/\"},{\"text\":\"Feature selection\",\"link\":\"/reference/sdemo/features/\"},{\"text\":\"Explanations\",\"link\":\"/reference/sdemo/explanations/\"},{\"text\":\"Changelog\",\"link\":\"/reference/sdemo/CHANGELOG/\"}]},{\"text\":\"SimpleSDMDatasets\",\"collapsed\":true,\"items\":[{\"text\":\"Documentation\",\"link\":\"/reference/datasets/\"},{\"text\":\"Interface\",\"link\":\"/reference/datasets/interface/\"},{\"text\":\"Types\",\"link\":\"/reference/datasets/types/\"},{\"text\":\"Internal\",\"link\":\"/reference/datasets/internals/\"},{\"text\":\"Changelog\",\"link\":\"/reference/datasets/CHANGELOG/\"}]},{\"text\":\"SimpleSDMLayers\",\"collapsed\":true,\"items\":[{\"text\":\"Documentation\",\"link\":\"/reference/layers/\"},{\"text\":\"Types\",\"link\":\"/reference/layers/types/\"},{\"text\":\"Operations\",\"link\":\"/reference/layers/operations/\"},{\"text\":\"Changelog\",\"link\":\"/reference/layers/CHANGELOG/\"}]},{\"text\":\"Contribute\",\"items\":[{\"text\":\"Code of Conduct\",\"link\":\"/reference/code-of-conduct/\"},{\"text\":\"Contribution guidelines\",\"link\":\"/reference/contributing/\"},{\"text\":\"Discussions\",\"link\":\"https://github.com/PoisotLab/SpeciesDistributionToolkit.jl/discussions\"},{\"text\":\"Good first issues\",\"link\":\"https://github.com/PoisotLab/SpeciesDistributionToolkit.jl/issues?q=is%3Aopen+is%3Aissue+label%3A%22good+first+issue%22\"}]}]},\"editLink\":{\"pattern\":\"https://github.com/PoisotLab/SpeciesDistributionToolkit.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/PoisotLab/SpeciesDistributionToolkit.jl\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/dev/\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a> by the <a href=\\\"https://poisotlab.io/\\\" target=\\\"_blank\\\">Computational Ecology Research Group</a><br>\",\"copyright\":\"This documentation is released under the <a href=\\\"https://creativecommons.org/licenses/by/4.0/deed.en\\\" target=\\\"_blank\\\">CC-BY 4.0 licence</a> - 2025\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>